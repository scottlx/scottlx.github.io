<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>拓扑排序(选课)</title>
<link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://scottlx.github.io/favicon.png rel=icon><meta name=description content><meta name=keywords content><meta name=author content="windseek"><meta name=generator content="Hugo 0.145.0"></head><body><header role=banner><hgroup><h1><a href=https://scottlx.github.io/>windseek</a></h1><h2>be curious, be free</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://scottlx.github.io/>» Blog</option><option value=https://scottlx.github.io/archives/>» Archives</option><option value=https://scottlx.github.io/cheatsheet/>» CheatSheet</option><option value=https://scottlx.github.io/about/>» Aboutme</option></select></fieldset><ul class=main-navigation><li><a href=https://scottlx.github.io/ title=Blog>Blog</a></li><li><a href=https://scottlx.github.io/archives/ title=Archives target=_blank rel="noopener noreferrer">Archives</a></li><li><a href=https://scottlx.github.io/cheatsheet/ title=CheatSheet target=_blank rel="noopener noreferrer">CheatSheet</a></li><li><a href=https://scottlx.github.io/about/ title=Aboutme target=_blank rel="noopener noreferrer">Aboutme</a></li></ul><ul class=subscription></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://scottlx.github.io/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Oct 12, 2022
- 1 minute read
- <a href=https://scottlx.github.io/posts/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/#disqus_thread>Comments</a>
- <a class=label href=https://scottlx.github.io/categories/%e7%ae%97%e6%b3%95%e7%ac%94%e8%ae%b0/>算法笔记</a></p><h1 class=entry-title>拓扑排序(选课)</h1></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#思路>思路</a></li><li><a href=#代码>代码</a></li><li><a href=#参考资料>参考资料</a></li></ul></nav><p><a href=https://leetcode.cn/problems/course-schedule/ target=_blank rel=noopener>207. 课程表 - 力扣（LeetCode）</a></p><h2 id=思路>思路</h2><p>课程之间的依赖关系可以用图来表示</p><ul><li>顶点：课程</li><li>边：有向的边，起点是前置课程，终点是后置课程</li></ul><p>这种图叫做AOV（Activity On Vertex）网络，字面意思就是边代表了节点之间的活动的先后关系。</p><p>按照题意，这个图是无环的（课程不能循环依赖），也就是DAG图。DAG图其实就是一颗树，只不过根节点是一个虚拟根节点（可以有多个起始根节点，但外面可以用一个虚拟根节点作为他们的父节点）。</p><p>因此，可以用广度优先遍历（BFS）来求解。队列存放可以选的课程（入度为0），依次出队列（选课）。直到队列为空（没有课可以选了），看是否已经学完所有的课程</p><ul><li>入度：指向自己的边的数量，入度为0表示自己没有前置课程，可以入队列</li><li>出度：指向别人的边。用一个数据结构记录每个节点的出度列表。当某个节点出队列时，更新本节点的出度列表里所有节点的入度（-1）</li></ul><h2 id=代码>代码</h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#268bd2>func</span> <span style=color:#268bd2>canFinish</span>(numCourses <span style=color:#dc322f>int</span>, prerequisites [][]<span style=color:#dc322f>int</span>) <span style=color:#dc322f>bool</span> {
</span></span><span style=display:flex><span>    <span style=color:#586e75>//保存各课程的入度 空间O(v)</span>
</span></span><span style=display:flex><span>    indegree <span style=color:#719e07>:=</span> <span style=color:#b58900>make</span>([]<span style=color:#dc322f>int</span>, numCourses)
</span></span><span style=display:flex><span>    <span style=color:#586e75>// 保存各课程的出度列表 空间O(e)</span>
</span></span><span style=display:flex><span>    courseMp <span style=color:#719e07>:=</span> <span style=color:#b58900>make</span>(<span style=color:#268bd2>map</span>[<span style=color:#dc322f>int</span>][]<span style=color:#dc322f>int</span>)
</span></span><span style=display:flex><span>    <span style=color:#586e75>//时间 O(e)</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> _, pre <span style=color:#719e07>:=</span> <span style=color:#719e07>range</span>(prerequisites) {
</span></span><span style=display:flex><span>        indegree[pre[<span style=color:#2aa198>0</span>]]<span style=color:#719e07>++</span>
</span></span><span style=display:flex><span>        courseMp[pre[<span style=color:#2aa198>1</span>]] = <span style=color:#b58900>append</span>(courseMp[pre[<span style=color:#2aa198>1</span>]], pre[<span style=color:#2aa198>0</span>])
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>var</span> q []<span style=color:#dc322f>int</span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// 已经学习了的课程的计数</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>var</span> num <span style=color:#dc322f>int</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>// 初始入度为0的课程加入队列</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> course, depends <span style=color:#719e07>:=</span> <span style=color:#719e07>range</span>(indegree) {
</span></span><span style=display:flex><span>        <span style=color:#719e07>if</span> depends <span style=color:#719e07>==</span> <span style=color:#2aa198>0</span> {
</span></span><span style=display:flex><span>            q = <span style=color:#b58900>append</span>(q, course)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>//循环直到队列为空 时间O(v)</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>for</span> <span style=color:#b58900>len</span>(q) &gt; <span style=color:#2aa198>0</span> {
</span></span><span style=display:flex><span>        <span style=color:#586e75>// 出队列</span>
</span></span><span style=display:flex><span>        finished <span style=color:#719e07>:=</span> q[<span style=color:#2aa198>0</span>]
</span></span><span style=display:flex><span>        q = q[<span style=color:#2aa198>1</span>:]
</span></span><span style=display:flex><span>        num<span style=color:#719e07>++</span>
</span></span><span style=display:flex><span>        <span style=color:#586e75>// 更新入度数据结构(slice)</span>
</span></span><span style=display:flex><span>        <span style=color:#586e75>// 从出度课程列表中直接取受影响的课程</span>
</span></span><span style=display:flex><span>        <span style=color:#719e07>for</span> _, course <span style=color:#719e07>:=</span> <span style=color:#719e07>range</span>(courseMp[finished]) {
</span></span><span style=display:flex><span>            indegree[course]<span style=color:#719e07>--</span>
</span></span><span style=display:flex><span>            <span style=color:#586e75>// 入度-1后若为0，则可以入队列</span>
</span></span><span style=display:flex><span>            <span style=color:#719e07>if</span> indegree[course] <span style=color:#719e07>==</span> <span style=color:#2aa198>0</span> {
</span></span><span style=display:flex><span>                q = <span style=color:#b58900>append</span>(q, course)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75>//是否学完</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>return</span> num <span style=color:#719e07>==</span> numCourses
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>时间复杂度：O (v+e)</li><li>空间复杂度: O(v+e)</li></ul><p>若需要省空间，不需要省时间，可以不使用courseMp存放出度数组，每次重新遍历prerequisites 获取出度数组。此时处理每个节点都需要重新遍历所有的边，因此：</p><ul><li>时间复杂度：O (v*e+e)</li><li>空间复杂度: O(v)</li></ul><h2 id=参考资料>参考资料</h2><p><a href=https://zhuanlan.zhihu.com/p/135094687 target=_blank rel=noopener>图文详解面试常考算法 —— 拓扑排序 - 知乎 (zhihu.com)</a></p><p><a href=https://leetcode.com/problems/course-schedule-ii/solution/ target=_blank rel=noopener>Course Schedule II - LeetCode</a></p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>windseek</span></span>
<time>Oct 12, 2022</time>
<span class=categories>Tags:
<a class=category href=https://scottlx.github.io/tags/go>go</a> <a class=category href=https://scottlx.github.io/tags/bfs>BFS</a> <a class=category href=https://scottlx.github.io/tags/dag>DAG</a> <a class=category href=https://scottlx.github.io/tags/%e7%ae%97%e6%b3%95>算法</a> <a class=category href=https://scottlx.github.io/tags/%e6%8b%93%e6%89%91%e6%8e%92%e5%ba%8f>拓扑排序</a></span></p><p class=meta><a class="basic-alignment left" href=https://scottlx.github.io/posts/%E4%BC%98%E5%8A%BF%E6%B4%97%E7%89%8C%E7%94%B0%E5%BF%8C%E8%B5%9B%E9%A9%AC/ title=优势洗牌(田忌赛马)>优势洗牌(田忌赛马)</a>
<a class="basic-alignment right" href=https://scottlx.github.io/posts/%E5%8D%95%E8%B0%83%E6%A0%88/ title=单调栈>单调栈</a></p><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//scottlx.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I</h1><p><p>云原生网络开发 &ndash;> 高级网管(笑</p><p>golang、云计算、SDN、NFV、软件架构</p><p>记录一些工作上的笔记，主要是以太网数据面开发（包括不限于dpdk，ebpf，ovs，dpvs，vpp&mldr;)以及k8s</p><p>也会记录一些web3方面的学习探索</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="noopener noreferrer" href=https://github.com/scottlx title=https://github.com/scottlx><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href="https://www.facebook.com/profile.php?id=100009824623685" title="https://www.facebook.com/profile.php?id=100009824623685"><i class="fa fa-facebook fa-3x"></i></a></li></ul><section class=odd></section><section class=even><h1>Recent Posts</h1><ul id=recent_posts></ul></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2025 windseek - <a href=https://scottlx.github.io/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>